# Задачи по авторизации и интеграции в AI Auto Applier

## 1. Настроить хранение секретных данных
    - Создать структуру для хранения `client_id` и `client_secret` для hh.ru и ключа/токена GigaChat (например, через `.env` файлы).
    - Описать инструкцию для разработчиков, как получать и хранить эти данные.

## 2. Реализовать endpoint генерации URL для авторизации hh.ru
    - Endpoint `/auth/hh/authorize` возвращает URL с параметрами OAuth2 (`response_type=code`, `client_id`, `redirect_uri`, `state` и доп. параметры).
    - Поддержать параметры `skip_choose_account` и `force_login`.

## 3. Реализовать callback endpoint для обработки ответа hh.ru
    - Endpoint `/auth/hh/callback` принимает `code`, `error`, `state` из redirect.
    - При получении `code` обменять его на `access_token` и `refresh_token` через API hh.ru.
    - Сохранить токены и срок действия в таблицу `ApiTokens`.

## 4. Реализовать endpoint обновления токенов hh.ru
    - Endpoint `/auth/hh/refresh` для обновления токена по `refresh_token`.
    - Запрос к API hh.ru для обновления пары токенов.
    - Обновить данные в таблице `ApiTokens`.

## 5. Реализовать авторизацию и хранение токенов для GigaChat
    - Изучить специфику авторизации GigaChat (API ключ, OAuth и т.п.).
    - Создать endpoint для хранения и обновления токенов GigaChat (если требуется).
    - Сохранить токены в таблице `ApiTokens`.

---

## 6. Создать модуль интеграции с API hh.ru
    - Методы для поиска вакансий, отправки откликов, получения информации о пользователе.
    - Использовать токены из `ApiTokens` для авторизации.

## 7. Создать модуль интеграции с API GigaChat
    - Методы для генерации сопроводительных писем на основе описания вакансии и резюме.
    - Обработка ошибок и таймаутов.

---

## 8. Описать Swagger спецификацию для авторизации и интеграций
    - Добавить все эндпоинты авторизации hh.ru и GigaChat.
    - Добавить схемы для `ApiTokens`, запросов и ответов.
    - Добавить описание ошибок (`400`, `401`, `500`) для всех эндпоинтов.

## 9. Реализовать backend API согласно спецификации
    - Обеспечить безопасное хранение и обновление токенов.
    - Корректная обработка ошибок и возврат HTTP-кодов.

---

## 10. Реализовать защиту API с использованием JWT и Bearer Token
    - Ограничить доступ к приватным endpoint’ам.
    - Обеспечить шифрование и безопасное хранение токенов.

## 11. Логирование доступа к персональным данным и действиям с токенами
    - Добавить логирование операций авторизации, обновления токенов и ошибок интеграции.

---

## Дополнительно

## 12. Настроить механизм автоматического обновления токенов
    - Запланировать задачу (cron/job) для регулярного обновления токенов.

## 13. Обеспечить возможность смены аккаунта/повторной авторизации для hh.ru
    - Поддержка параметров `force_login` и `skip_choose_account` в интерфейсе и API.